# Template file for 'WoeUSB'
pkgname=WoeUSB
version=5.2.4
revision=1
_gui_version=3.3.0
wrksrc="WoeUSB-frontend-wxgtk-${_gui_version}"
build_style=gnu-configure
configure_args="--with-wx-config=wx-config-gtk3"
hostmakedepends="automake gettext libtool"
makedepends="wxWidgets-gtk3-devel"
depends="WoeUSB-cli"
short_desc="Create a Windows USB stick installer from a real Windows DVD or image"
maintainer="bra1nwave <bra1nwave@protonmail.com>"
license="GPL-3.0-or-later"
homepage="https://github.com/WoeUSB/WoeUSB-frontend-wxgtk"
distfiles="
 https://github.com/WoeUSB/WoeUSB-frontend-wxgtk/archive/refs/tags/v${_gui_version}.tar.gz
 https://github.com/WoeUSB/WoeUSB/archive/refs/tags/v${version}.tar.gz"
checksum="
 5fcfd6e86388c3d4daf85a3a226ca4a42a336c862dcfa1c1af1ead5d77d81b63
 8305296d49b7b58c200f9d373eac8dd494d03442737183749a0ee166403a7e68"

post_patch() {
	mv -f "${XBPS_BUILDDIR}/WoeUSB-${version}/sbin/woeusb" src/woeusb
	vsed -i -e "s/@@WOEUSB_VERSION@@/$version/g" \
		configure.ac src/woeusb.1 src/woeusbgui.1
}

pre_configure() {
	autoreconf -fi
}

WoeUSB-cli_package() {
	depends="bash grub ntfs-3g parted wget"
	short_desc+=" - command line only"
	pkg_install() {
		vmove usr/bin/woeusb
		vmove usr/share/man/man1/woeusb.1
	}
}

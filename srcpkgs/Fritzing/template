# Template file for 'Fritzing'
pkgname=Fritzing
version=0.9.6
revision=1
_partshash="d378502a6dd416aff5f4de002b58e47a7afe3d24"
wrksrc="fritzing-app-${version}"
build_style=qmake
hostmakedepends="qt5-qmake qt5-host-tools"
makedepends="qt5-devel qt5-serialport-devel qt5-svg-devel boost-devel libgit2-devel"
depends="qt5-plugin-sqlite"
short_desc="Software for electronics prototyping"
maintainer="Steve Prybylski <sa.prybylx@gmail.com>"
license="GPL-3.0-or-later, CC-BY-SA-3.0"
homepage="http://fritzing.org"
distfiles="https://github.com/${pkgname}/${pkgname}-app/archive/refs/tags/${version}.tar.gz>fritzing-app-${version}.tar.gz
 https://github.com/${pkgname}/${pkgname}-parts/archive/${_partshash}.tar.gz>fritzing-parts-${_partshash}.tar.gz"
checksum="eb4ebe461c5d42edb4b10f1f824e7c855ad54555e222c5999061dead09834491
 2b3fa759c9995de0399b3556651285c9947ebe82d1bc220b6f3c546f002766f3"

post_extract() {
	# look for libgit2 in the source tree
	# make it use the system libraries
	sed -i -e "/LIBGIT2INCLUDE/s/\$\$_PRO_FILE_PWD_\/..\/libgit2\/include/${XBPS_CROSS_BASE}\/usr\/include/" \
	 -e "/LIBGIT2LIB/s/\$\$_PRO_FILE_PWD_\/..\/libgit2\/build/${XBPS_CROSS_BASE}\/usr\/lib/" \
	 -e "/\$\$LIBGIT2LIB/s/libgit2.a/libgit2.so/" \
	 pri/libgit2detect.pri
}

post_install() {
	mv ${XBPS_BUILDDIR}/fritzing-parts-$_partshash/ ${DESTDIR}/usr/share/fritzing/parts
	mv ${DESTDIR}/usr/bin/Fritzing{,-bin}
	vbin ${FILESDIR}/Fritzing
}
